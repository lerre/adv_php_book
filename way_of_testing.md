完备的单元测试
===========
## 我对测试的几个基本观点
### 100%覆盖
#### 测试的核心是用例100%覆盖
是指一个被测试方法的各种情况尽可能遍历到

#### 不是指Code Coverage 100%
Code Coverage即自动扫描工具扫出来的测试覆盖率，它只反应了有多少个类多少个方法有测试用例，并不能反应，这个类，已有的测试用例够不够全面

#### 伤其十指不如断其一指
100个方法每个方法一个测试用例，不如一个方法有100个测试用例，

### 自动化运行
#### 100%覆盖的前提是自动化运行
若不能实现自动化测试，人工运行和判读结果的时间成本太高。每天回归测试和持续集成将不具备可行性。没有自动化运行的支持，测试用例设计得越多，测试人员的工作负担越大，反倒是甜蜜的烦恼啦。

#### 服务端自动化测试工具
主要有xUnit系列：

- Junit (for Java)
- PHPUnit and SimplestTest(for PHP)
- OCUnit (for Objective-C)
- NUnit (for .Net)
- DBUnit (for SQL DB)

#### 浏览器端自动化测试工具
主要有:

- Selenium
- Watir
- HTTPUnit
- HTMLUnit
- JSUnit

__注__：上述工具虽然被归为浏览器端测试，但实际上，也可以运行在服务端，如JSUnit可用于服务端Node.js代码的自动化测试

### 变化的业务，不变的接口
#### 业务变化快
我们经常碰到的第一个问题是，业务变化快，担心花大力气编写的测试用例还没跑够一个月就又用不上了。我常听同事苦闷地说：我这个业务变化太快，没法做自动化测试。这个问题可以从两方面缓解一下：

- 找出相对变化不快的：如底层操作（存储、引擎）、成熟的主线业务
- 设计可隔离变化的技术方案，如页面布局可以每月一个新版，但GET、POST字段名不变，这样用HTTPUnit运行的测试用例便可以重复使用了

#### 优先在哪做自动化测试
第二个问题是，我们的组织往往追求多快好省，无论是开发人员还是测试人员，用来写测试用例的时候，可付出的人月数有限，优先在哪做自动化测试呢？

- 变化频繁的：再简单的业务，经常变，一定会出bug，要相信墨菲定律
- 逻辑复杂的

### 单元测试和集成验收测试的关系
#### 集成验收测试是质量的最后屏障
目前业界大公司主要靠测试妹子们人肉测试来保障，有的公司甚至没有专职的测试人员，靠开发人员的自律来保障软件质量。

#### 单元测试帮助提高质量和快速定位问题
单元测试帮助开发人员更好地自测，以向测试人员提交更高质量的软件，有利于降低集成测试的成本。

同样一个bug，在开发人员自测阶段被单元测试发现，比在集成测试阶段发现的代价小很多。

若在集成测试阶段出现bug，单元测试可以帮助快速定位问题，一般来说，测试用例覆盖低的方法或类，出现bug的可能性大一些。

#### 工具可以共享
各种xUnit工具可以用在自动化集成测试中